"use strict";(globalThis["webpackChunkfirefly_iii"]=globalThis["webpackChunkfirefly_iii"]||[]).push([[6254],{6254:(e,t,a)=>{a.r(t),a.d(t,{default:()=>C});var i=a(9835),n=a(6970);const s=(0,i.Uk)("Edit"),o=(0,i.Uk)("Delete");function r(e,t,a,r,l,g){const p=(0,i.up)("q-th"),u=(0,i.up)("q-tr"),d=(0,i.up)("router-link"),m=(0,i.up)("q-td"),c=(0,i.up)("q-item-label"),h=(0,i.up)("q-item-section"),w=(0,i.up)("q-item"),f=(0,i.up)("q-list"),b=(0,i.up)("q-btn-dropdown"),y=(0,i.up)("q-table"),k=(0,i.up)("q-fab-action"),_=(0,i.up)("q-fab"),q=(0,i.up)("q-page-sticky"),Z=(0,i.up)("q-page"),P=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(Z,null,{default:(0,i.w5)((()=>[(0,i.Wm)(y,{pagination:l.pagination,"onUpdate:pagination":t[0]||(t[0]=e=>l.pagination=e),columns:l.columns,loading:l.loading,rows:l.rows,title:e.$t("firefly.piggy-banks"),class:"q-ma-md","row-key":"id",onRequest:g.onRequest},{header:(0,i.w5)((e=>[(0,i.Wm)(u,{props:e},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.cols,(t=>((0,i.wg)(),(0,i.j4)(p,{key:t.name,props:e},{default:(0,i.w5)((()=>[(0,i.Uk)((0,n.zw)(t.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,i.w5)((e=>[(0,i.Wm)(u,{props:e},{default:(0,i.w5)((()=>[(0,i.Wm)(m,{key:"name",props:e},{default:(0,i.w5)((()=>[(0,i.Wm)(d,{to:{name:"piggy-banks.show",params:{id:e.row.id}},class:"text-primary"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,n.zw)(e.row.name),1)])),_:2},1032,["to"])])),_:2},1032,["props"]),(0,i.Wm)(m,{key:"menu",props:e},{default:(0,i.w5)((()=>[(0,i.Wm)(b,{color:"primary",label:"Actions",size:"sm"},{default:(0,i.w5)((()=>[(0,i.Wm)(f,null,{default:(0,i.w5)((()=>[(0,i.wy)(((0,i.wg)(),(0,i.j4)(w,{to:{name:"piggy-banks.edit",params:{id:e.row.id}},clickable:""},{default:(0,i.w5)((()=>[(0,i.Wm)(h,null,{default:(0,i.w5)((()=>[(0,i.Wm)(c,null,{default:(0,i.w5)((()=>[s])),_:1})])),_:1})])),_:2},1032,["to"])),[[P]]),(0,i.wy)(((0,i.wg)(),(0,i.j4)(w,{clickable:"",onClick:t=>g.deletePiggyBank(e.row.id,e.row.name)},{default:(0,i.w5)((()=>[(0,i.Wm)(h,null,{default:(0,i.w5)((()=>[(0,i.Wm)(c,null,{default:(0,i.w5)((()=>[o])),_:1})])),_:1})])),_:2},1032,["onClick"])),[[P]])])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"])])),_:2},1032,["props"])])),_:1},8,["pagination","columns","loading","rows","title","onRequest"]),(0,i.Wm)(q,{offset:[18,18],position:"bottom-right"},{default:(0,i.w5)((()=>[(0,i.Wm)(_,{color:"green",direction:"up",icon:"fas fa-chevron-up",label:"Actions","label-position":"left",square:"","vertical-actions-align":"right"},{default:(0,i.w5)((()=>[(0,i.Wm)(k,{to:{name:"piggy-banks.create"},color:"primary",icon:"fas fa-exchange-alt",label:"New piggy bank",square:""},null,8,["to"])])),_:1})])),_:1})])),_:1})}var l=a(7913),g=a(1569);class p{list(e,t){let a="/api/v1/piggy_banks";return g.api.get(a,{params:{page:e,cache:t}})}}var u=a(3555);const d={name:"Index",watch:{$route(e){"piggy-banks.index"===e.name&&(this.page=1,this.updateBreadcrumbs(),this.triggerUpdate())}},data(){return{rows:[],pagination:{sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:100},loading:!1,columns:[{name:"name",label:"Name",field:"name",align:"left"},{name:"menu",label:" ",field:"menu",align:"right"}],store:null}},computed:{},created(){this.pagination.rowsPerPage=this.getListPageSize,this.store=(0,u.S)()},mounted(){null!==this.store.getRange.start&&null!==this.store.getRange.end||this.store.$onAction((({name:e,$store:t,args:a,after:i,onError:n})=>{i((t=>{"setRange"===e&&(this.range=t,this.triggerUpdate())}))})),null!==this.store.getRange.start&&null!==this.store.getRange.end&&(this.range={start:this.store.getRange.start,end:this.store.getRange.end},this.triggerUpdate())},methods:{deletePiggyBank:function(e,t){this.$q.dialog({title:"Confirm",message:'Do you want to delete piggy bank "'+t+'"?',cancel:!0,persistent:!0}).onOk((()=>{this.destroyPiggyBank(e)}))},destroyPiggyBank:function(e){new l.Z("piggy_banks").destroy(e).then((()=>{this.store.refreshCacheKey(),this.triggerUpdate()}))},updateBreadcrumbs:function(){this.$route.meta.pageTitle="firefly.piggy-banks",this.$route.meta.breadcrumbs=[{title:"piggy-banks"}]},onRequest:function(e){this.page=e.pagination.page,this.triggerUpdate()},triggerUpdate:function(){if(this.loading)return;if(null===this.range.start||null===this.range.end)return;this.loading=!0;const e=new p;this.rows=[],e.list(this.page,this.getCacheKey).then((e=>{this.pagination.rowsPerPage=e.data.meta.pagination.per_page,this.pagination.rowsNumber=e.data.meta.pagination.total,this.pagination.page=this.page;for(let t in e.data.data)if(e.data.data.hasOwnProperty(t)){let a=e.data.data[t],i={id:a.id,name:a.attributes.name};this.rows.push(i)}this.loading=!1}))}}};var m=a(1639),c=a(9885),h=a(2429),w=a(3532),f=a(1682),b=a(7220),y=a(2045),k=a(3246),_=a(490),q=a(1233),Z=a(3115),P=a(3388),W=a(9361),Q=a(935),R=a(2146),U=a(9984),v=a.n(U);const B=(0,m.Z)(d,[["render",r]]),C=B;v()(d,"components",{QPage:c.Z,QTable:h.Z,QTr:w.Z,QTh:f.Z,QTd:b.Z,QBtnDropdown:y.Z,QList:k.Z,QItem:_.Z,QItemSection:q.Z,QItemLabel:Z.Z,QPageSticky:P.Z,QFab:W.Z,QFabAction:Q.Z}),v()(d,"directives",{ClosePopup:R.Z})}}]);