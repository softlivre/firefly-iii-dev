"use strict";(globalThis["webpackChunkfirefly_iii"]=globalThis["webpackChunkfirefly_iii"]||[]).push([[9729],{9729:(e,t,a)=>{a.r(t),a.d(t,{default:()=>x});var l=a(9835),o=a(6970);const i=(0,l.Uk)("Edit"),r=(0,l.Uk)("Delete"),n=(0,l.Uk)("Edit group "),s=(0,l.Uk)("Delete group ");function u(e,t,a,u,p,d){const g=(0,l.up)("q-th"),c=(0,l.up)("q-tr"),m=(0,l.up)("router-link"),w=(0,l.up)("q-td"),f=(0,l.up)("q-item-label"),h=(0,l.up)("q-item-section"),y=(0,l.up)("q-item"),_=(0,l.up)("q-list"),b=(0,l.up)("q-btn-dropdown"),k=(0,l.up)("q-table"),q=(0,l.up)("q-btn"),Z=(0,l.up)("q-btn-group"),W=(0,l.up)("q-card-actions"),Q=(0,l.up)("q-card"),C=(0,l.up)("q-fab-action"),G=(0,l.up)("q-fab"),R=(0,l.up)("q-page-sticky"),U=(0,l.up)("q-page"),I=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)(U,null,{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(p.ruleGroups,(t=>((0,l.wg)(),(0,l.j4)(Q,{class:"q-ma-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{columns:p.columns,dense:e.$q.screen.lt.md,loading:t.loading,pagination:p.pagination,rows:t.rules,title:t.title,"row-key":"id"},{header:(0,l.w5)((e=>[(0,l.Wm)(c,{props:e},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.cols,(t=>((0,l.wg)(),(0,l.j4)(g,{key:t.name,props:e},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(t.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,l.w5)((e=>[(0,l.Wm)(c,{props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{key:"name",props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{to:{name:"rules.show",params:{id:e.row.id}},class:"text-primary"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.row.title),1)])),_:2},1032,["to"])])),_:2},1032,["props"]),(0,l.Wm)(w,{key:"menu",props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{color:"primary",label:"Actions",size:"sm"},{default:(0,l.w5)((()=>[(0,l.Wm)(_,null,{default:(0,l.w5)((()=>[(0,l.wy)(((0,l.wg)(),(0,l.j4)(y,{to:{name:"rules.edit",params:{id:e.row.id}},clickable:""},{default:(0,l.w5)((()=>[(0,l.Wm)(h,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[i])),_:1})])),_:1})])),_:2},1032,["to"])),[[I]]),(0,l.wy)(((0,l.wg)(),(0,l.j4)(y,{clickable:"",onClick:t=>d.deleteRule(e.row.id,e.row.title)},{default:(0,l.w5)((()=>[(0,l.Wm)(h,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[r])),_:1})])),_:1})])),_:2},1032,["onClick"])),[[I]])])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"])])),_:2},1032,["props"])])),_:2},1032,["columns","dense","loading","pagination","rows","title"]),(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Z,null,{default:(0,l.w5)((()=>[(0,l.Wm)(q,{to:{name:"rule-groups.edit",params:{id:t.id}},color:"primary",size:"sm"},{default:(0,l.w5)((()=>[n])),_:2},1032,["to"]),(0,l.Wm)(q,{color:"primary",size:"sm",onClick:e=>d.deleteRuleGroup(t.id,t.title)},{default:(0,l.w5)((()=>[s])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),256)),(0,l.Wm)(R,{offset:[18,18],position:"bottom-right"},{default:(0,l.w5)((()=>[(0,l.Wm)(G,{color:"green",direction:"up",icon:"fas fa-chevron-up",label:"Actions","label-position":"left",square:"","vertical-actions-align":"right"},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{to:{name:"rule-groups.create"},color:"primary",icon:"fas fa-exchange-alt",label:"New rule group",square:""},null,8,["to"]),(0,l.Wm)(C,{to:{name:"rules.create"},color:"primary",icon:"fas fa-exchange-alt",label:"New rule",square:""},null,8,["to"])])),_:1})])),_:1})])),_:1})}var p=a(2416),d=a(6739),g=a(7913),c=a(3555);const m={name:"Index",watch:{$route(e){"rules.index"===e.name&&this.triggerUpdate()}},mounted(){this.store=(0,c.S)(),this.triggerUpdate()},data(){return{pagination:{page:1,rowsPerPage:0},columns:[{name:"name",label:"Name",field:"name",align:"left"},{name:"menu",label:" ",field:"menu",align:"right"}],ruleGroups:{},store:null}},computed:{},methods:{triggerUpdate:function(){this.loading||(this.loading=!0,this.ruleGroups={},this.getPage(1))},deleteRule:function(e,t){this.$q.dialog({title:"Confirm",message:'Do you want to delete rule "'+t+'"?',cancel:!0,persistent:!0}).onOk((()=>{this.destroyRule(e)}))},deleteRuleGroup:function(e,t){this.$q.dialog({title:"Confirm",message:'Do you want to delete rule group "'+t+'"?',cancel:!0,persistent:!0}).onOk((()=>{this.destroyRuleGroup(e)}))},destroyRuleGroup:function(e){new g.Z("rule_groups").destroy(e).then((()=>{this.store.refreshCacheKey(),this.triggerUpdate()}))},destroyRule:function(e){new g.Z("rules").destroy(e).then((()=>{this.store.refreshCacheKey(),this.triggerUpdate()}))},getPage:function(e){const t=new p.Z;this.rows=[],t.list(e,this.getCacheKey).then((t=>{e<parseInt(t.data.meta.pagination.total_pages)&&this.getPage(e+1);for(let e in t.data.data)if(t.data.data.hasOwnProperty(e)){let a=t.data.data[e],l=parseInt(a.id);this.ruleGroups[l]={id:l,title:a.attributes.title,rules:[],loading:!0},this.getRules(l,1)}e===parseInt(t.data.meta.pagination.total_pages)&&(this.loading=!1)}))},getRules:function(e,t){const a=new d.Z;this.rows=[],a.rules(e,t,this.getCacheKey).then((a=>{t<parseInt(a.data.meta.pagination.total_pages)&&this.getRules(e,t+1);for(let t in a.data.data)if(a.data.data.hasOwnProperty(t)){let l=a.data.data[t],o=parseInt(l.id),i={id:o,title:l.attributes.title};this.ruleGroups[e].rules.push(i)}t===parseInt(a.data.meta.pagination.total_pages)&&(this.ruleGroups[e].loading=!1)}))}}};var w=a(1639),f=a(9885),h=a(4458),y=a(2429),_=a(3532),b=a(1682),k=a(7220),q=a(2045),Z=a(3246),W=a(490),Q=a(1233),C=a(3115),G=a(1821),R=a(7236),U=a(8879),I=a(3388),P=a(9361),D=a(935),v=a(2146),K=a(9984),T=a.n(K);const j=(0,w.Z)(m,[["render",u]]),x=j;T()(m,"components",{QPage:f.Z,QCard:h.Z,QTable:y.Z,QTr:_.Z,QTh:b.Z,QTd:k.Z,QBtnDropdown:q.Z,QList:Z.Z,QItem:W.Z,QItemSection:Q.Z,QItemLabel:C.Z,QCardActions:G.Z,QBtnGroup:R.Z,QBtn:U.Z,QPageSticky:I.Z,QFab:P.Z,QFabAction:D.Z}),T()(m,"directives",{ClosePopup:v.Z})}}]);