"use strict";(globalThis["webpackChunkfirefly_iii"]=globalThis["webpackChunkfirefly_iii"]||[]).push([[9173],{9173:(e,t,a)=>{a.r(t),a.d(t,{default:()=>C});var n=a(9835),l=a(6970);const i=(0,n.Uk)(" A "),o=(0,n.Uk)(" B "),s=(0,n.Uk)(" C ");function r(e,t,a,r,u,p){const d=(0,n.up)("q-th"),c=(0,n.up)("q-tr"),m=(0,n.up)("router-link"),g=(0,n.up)("q-input"),f=(0,n.up)("q-popup-edit"),w=(0,n.up)("q-td"),h=(0,n.up)("q-item-label"),b=(0,n.up)("q-item-section"),y=(0,n.up)("q-item"),_=(0,n.up)("q-list"),k=(0,n.up)("q-btn-dropdown"),U=(0,n.up)("q-table"),W=(0,n.up)("q-fab-action"),$=(0,n.up)("q-fab"),q=(0,n.up)("q-page-sticky"),Z=(0,n.up)("q-page"),v=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.j4)(Z,null,{default:(0,n.w5)((()=>[(0,n.Wm)(U,{pagination:u.pagination,"onUpdate:pagination":t[0]||(t[0]=e=>u.pagination=e),columns:u.columns,dense:e.$q.screen.lt.md,loading:u.loading,rows:u.rows,title:e.$t("firefly."+this.type+"_accounts"),class:"q-ma-md","row-key":"id"},{header:(0,n.w5)((e=>[(0,n.Wm)(c,{props:e},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.cols,(t=>((0,n.wg)(),(0,n.j4)(d,{key:t.name,props:e},{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(t.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,n.w5)((t=>[(0,n.Wm)(c,{props:t},{default:(0,n.w5)((()=>[(0,n.Wm)(w,{key:"name",props:t},{default:(0,n.w5)((()=>[(0,n.Wm)(m,{to:{name:"accounts.show",params:{id:t.row.id}},class:"text-primary"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(t.row.name),1)])),_:2},1032,["to"]),(0,n.Wm)(f,{modelValue:t.row.name,"onUpdate:modelValue":e=>t.row.name=e},{default:(0,n.w5)((e=>[(0,n.Wm)(g,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,autofocus:"",counter:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["props"]),(0,n.Wm)(w,{key:"iban",props:t},{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(p.formatIban(t.row.iban))+" ",1),(0,n.Wm)(f,{modelValue:t.row.iban,"onUpdate:modelValue":e=>t.row.iban=e},{default:(0,n.w5)((e=>[(0,n.Wm)(g,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,autofocus:"",counter:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["props"]),(0,n.Wm)(w,{key:"current_balance",props:t},{default:(0,n.w5)((()=>[i])),_:2},1032,["props"]),(0,n.Wm)(w,{key:"active",props:t},{default:(0,n.w5)((()=>[o])),_:2},1032,["props"]),(0,n.Wm)(w,{key:"last_activity",props:t},{default:(0,n.w5)((()=>[s])),_:2},1032,["props"]),(0,n.Wm)(w,{key:"menu",props:t},{default:(0,n.w5)((()=>[(0,n.Wm)(k,{label:e.$t("firefly.actions"),color:"primary",size:"sm"},{default:(0,n.w5)((()=>[(0,n.Wm)(_,null,{default:(0,n.w5)((()=>[(0,n.wy)(((0,n.wg)(),(0,n.j4)(y,{to:{name:"accounts.edit",params:{id:t.row.id}},clickable:""},{default:(0,n.w5)((()=>[(0,n.Wm)(b,null,{default:(0,n.w5)((()=>[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.$t("firefly.edit")),1)])),_:1})])),_:1})])),_:2},1032,["to"])),[[v]]),"asset"===t.row.type?(0,n.wy)(((0,n.wg)(),(0,n.j4)(y,{key:0,to:{name:"accounts.reconcile",params:{id:t.row.id}},clickable:""},{default:(0,n.w5)((()=>[(0,n.Wm)(b,null,{default:(0,n.w5)((()=>[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.$t("firefly.reconcile")),1)])),_:1})])),_:1})])),_:2},1032,["to"])),[[v]]):(0,n.kq)("",!0),(0,n.wy)(((0,n.wg)(),(0,n.j4)(y,{clickable:"",onClick:e=>p.deleteAccount(t.row.id,t.row.name)},{default:(0,n.w5)((()=>[(0,n.Wm)(b,null,{default:(0,n.w5)((()=>[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.$t("firefly.delete")),1)])),_:1})])),_:1})])),_:2},1032,["onClick"])),[[v]])])),_:2},1024)])),_:2},1032,["label"])])),_:2},1032,["props"])])),_:2},1032,["props"])])),_:1},8,["pagination","columns","dense","loading","rows","title"]),(0,n.Wm)(q,{offset:[18,18],position:"bottom-right"},{default:(0,n.w5)((()=>[(0,n.Wm)($,{label:e.$t("firefly.actions"),color:"green",direction:"up",icon:"fas fa-chevron-up","label-position":"left",square:"","vertical-actions-align":"right"},{default:(0,n.w5)((()=>[(0,n.Wm)(W,{label:e.$t("firefly.create_new_asset"),to:{name:"accounts.create",params:{type:"asset"}},color:"primary",icon:"fas fa-exchange-alt",square:""},null,8,["label","to"])])),_:1},8,["label"])])),_:1})])),_:1})}var u=a(3836),p=a(7913),d=a(3555);const c={name:"Index",watch:{$route(e){"accounts.index"===e.name&&(this.type=e.params.type,this.page=1,this.updateBreadcrumbs(),this.triggerUpdate())}},data(){return{rows:[],type:"asset",pagination:{sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:100},loading:!1,columns:[{name:"name",label:this.$t("list.name"),field:"name",align:"left"},{name:"iban",label:this.$t("list.account_number"),field:"iban",align:"left"},{name:"current_balance",label:this.$t("list.currentBalance"),field:"current_balance",align:"left"},{name:"active",label:this.$t("list.active"),field:"active",align:"left"},{name:"last_activity",label:this.$t("list.lastActivity"),field:"last_activity",align:"left"},{name:"menu",label:" ",field:"menu",align:"right"}],store:null}},computed:{},created(){this.store=(0,d.S)(),this.pagination.rowsPerPage=this.getListPageSize},mounted(){this.type=this.$route.params.type,null!==this.store.getRange.start&&null!==this.store.getRange.end||this.store.$onAction((({name:e,$store:t,args:a,after:n,onError:l})=>{n((t=>{"setRange"===e&&(this.range=t,this.triggerUpdate())}))})),null!==this.store.getRange.start&&null!==this.store.getRange.end&&(this.range={start:this.store.getRange.start,end:this.store.getRange.end},this.triggerUpdate())},methods:{deleteAccount:function(e,t){this.$q.dialog({title:this.$t("firefly.confirm_action"),message:'Do you want to delete account "'+t+'"? Any and all transactions linked to this account will ALSO be deleted.',cancel:!0,persistent:!0}).onOk((()=>{this.destroyAccount(e)}))},destroyAccount:function(e){new p.Z("accounts").destroy(e).then((()=>{this.rows=[],this.store.refreshCacheKey().then((()=>{this.triggerUpdate()}))}))},updateBreadcrumbs:function(){this.$route.meta.pageTitle="firefly."+this.type+"_accounts",this.$route.meta.breadcrumbs=[{title:this.type+"_accounts"}]},onRequest:function(e){this.page=e.pagination.page,this.triggerUpdate()},formatIban:function(e){if(null===e)return"";let t=/[^a-zA-Z0-9]/g,a=/(.{4})(?!$)/g;return e.replace(t,"").toUpperCase().replace(a,"$1 ")},triggerUpdate:function(){if(this.rows=[],!0===this.loading)return;if(null===this.range.start||null===this.range.end)return;this.loading=!0;const e=new u.Z;this.rows=[],e.list(this.type,this.page,this.getCacheKey).then((e=>{this.pagination.rowsPerPage=e.data.meta.pagination.per_page,this.pagination.rowsNumber=e.data.meta.pagination.total,this.pagination.page=this.page;for(let t in e.data.data)if(e.data.data.hasOwnProperty(t)){let a=e.data.data[t],n={id:a.id,name:a.attributes.name,iban:a.attributes.iban,type:a.attributes.type};this.rows.push(n)}this.loading=!1})).catch((e=>{console.error("Error loading list"),console.error(e)}))}}};var m=a(1639),g=a(9885),f=a(2429),w=a(3532),h=a(1682),b=a(7220),y=a(5863),_=a(6611),k=a(2045),U=a(3246),W=a(490),$=a(1233),q=a(3115),Z=a(3388),v=a(9361),Q=a(935),V=a(2146),P=a(9984),A=a.n(P);const z=(0,m.Z)(c,[["render",r]]),C=z;A()(c,"components",{QPage:g.Z,QTable:f.Z,QTr:w.Z,QTh:h.Z,QTd:b.Z,QPopupEdit:y.Z,QInput:_.Z,QBtnDropdown:k.Z,QList:U.Z,QItem:W.Z,QItemSection:$.Z,QItemLabel:q.Z,QPageSticky:Z.Z,QFab:v.Z,QFabAction:Q.Z}),A()(c,"directives",{ClosePopup:V.Z})}}]);